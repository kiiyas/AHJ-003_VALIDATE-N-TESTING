(()=>{"use strict";class t{constructor(t){this.cardnumber=t,this.systems={mir:2,amex:3,visa:4,master:5,discover:6}}getSystem(){const t=this.cardnumber.substring(0,1).split("").map(Number)[0];return Object.entries(this.systems).find((e=>e[1]===t))[0]}}class e{constructor(t){this.cardnumber=t}cardValidator(){if(16===this.cardnumber.toString().length)return this.hasSameDigitValidator();throw new Error("Номер не полный!")}hasSameDigitValidator(){const t=this.cardnumber.substring(15,16).split("").map(Number);return this.validateDigitCalculate()===t[0]}validateDigitCalculate(){const t=this.digitsSumCalculate(),e=t/10;return 10*Math.ceil(e)-t}digitsSumCalculate(){return this.cardnumber.substring(0,15).split("").map(Number).map(((t,e)=>e%2==0?2*t:t)).map(((t,e)=>t>9?t-9:t)).reduce(((t,e)=>t+e))}chekCard(){return new t(this.cardnumber).getSystem()}}class s{constructor(t,e){this.validity=t,this.system=e,this.input=document.querySelector("#control"),this.tooltip=document.querySelector(".tooltip"),this.card=document.querySelector(".card"),this.cardlist=document.querySelector(".cardlist"),this.recievedNumber=null}generateTooltip(){"Карта валидна!"===this.validity?(this.tooltip.classList.remove("forInvalid"),this.tooltip.classList.add("forValid")):(this.tooltip.classList.remove("forValid"),this.tooltip.classList.add("forInvalid")),this.tooltip.textContent=this.validity}showCardSystem(){const t=document.getElementsByClassName("blur");if(t[0]&&t[0].classList.remove("blur"),"Карта валидна!"===this.validity){document.getElementsByClassName(this.system)[0].classList.add("blur")}}}class r{constructor(){this.input=document.querySelector("#control"),this.button=document.querySelector("#submitform"),this.recievedNumber=null}getCardNumber(){return this.recievedNumber=this.input.value,this.recievedNumber}}document.addEventListener("click",(t=>{if(t.target===document.querySelector("#submitform")){t.preventDefault();const i=(new r).getCardNumber(),a=new e(i),o=a.cardValidator()?"Карта валидна!":"Что-то не так, повторите снова.",c=a.chekCard(),l=new s(o,c);l.generateTooltip(),l.showCardSystem()}}))})();